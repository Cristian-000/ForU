<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rutina Semanal Flexible - Personalizada (Tablas Compactas Móvil)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Estilos CSS - Tablas MUY compactas para móvil */
        body { font-family: 'Arial', sans-serif; margin: 10px; color: #333; line-height: 1.4; background-color: #f8f8f8; font-size: 15px; } /* Reducido el tamaño de fuente base y márgenes body */
        h1, h2, h3 { color: #0056b3; }
        h1 { text-align: center; margin-bottom: 15px; font-size: 26px; } /* Reducido margin-bottom y font-size h1 */
        h2 { margin-top: 20px; border-bottom: 1px solid #0056b3; padding-bottom: 3px; font-size: 20px; } /* Reducido margin-top, border-bottom, padding-bottom y font-size h2 */
        h3 { margin-top: 15px; font-size: 17px; } /* Reducido margin-top y font-size h3 */
        table { width: 100%; border-collapse: collapse; margin-top: 5px; background-color: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 5px; overflow: hidden; margin-bottom: 10px; font-size: 14px; } /* Reducido margin-top, margin-bottom y font-size table, box-shadow y border-radius */
        th, td { border: 1px solid #ddd; padding: 6px; text-align: left; font-size: 13px; } /* Padding y font-size MUY reducidos en th y td */
        th { background-color: #0056b3; color: white; font-weight: bold; text-transform: uppercase; padding: 8px 6px; font-size: 12px; } /* Ajustado padding y font-size en th */
        tbody tr:nth-child(even) { background-color: #f9f9f9; }
        ul { list-style-type: none; padding-left: 0; margin-top: 2px; margin-bottom: 2px; } /* Reducido margin ul */
        li { margin-bottom: 4px; font-size: 14px; } /* Reducido margin-bottom y font-size li */
        .nota { font-style: italic; color: #777; margin-top: 10px; display: block; text-align: center; font-size: 13px; } /* Reducido margin-top y font-size nota */
        button, .generar-btn, .guardar-btn, .cargar-btn, .reset-btn { background-color: #0056b3; color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; margin-top: 10px; font-size: 14px; transition: background-color 0.3s ease; display: inline-block; } /* Padding, border-radius, margin-top y font-size reducidos en botones */
        button:hover, .generar-btn:hover, .guardar-btn:hover, .cargar-btn:hover, .reset-btn:hover { background-color: #004488; }
        button i, .generar-btn i, .guardar-btn i, .cargar-btn i, .reset-btn i { margin-right: 5px; } /* Reducido margin-right icono botón */
        .botones-container { text-align: center; margin-bottom: 15px; } /* Reducido margin-bottom botones-container */
        .opciones-lista { margin-bottom: 5px; } /* Reducido margin-bottom opciones-lista */
        .opciones-lista ul { margin-top: 2px; margin-bottom: 2px; } /* Reducido margin ul en opciones-lista */
        .opcion-item { padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 3px; background-color: #f0f8ff; display: flex; justify-content: space-between; align-items: center; font-size: 14px; } /* Padding, border-radius, margin-bottom y font-size opcion-item */
        .opcion-texto { flex-grow: 1; }
        .opcion-botones { display: flex; gap: 3px; } /* Reducido gap botones opcion-botones */
        .opcion-botones button { padding: 4px 8px; font-size: 0.8em; margin-top: 0; border-radius: 4px; } /* Padding, font-size y border-radius botones internos opcion-botones */
        .opcion-botones button.seleccionar-btn { background-color: #28a745; }
        .opcion-botones button.seleccionar-btn:hover { background-color: #218838; }
        .seleccionado { background-color: #e0f7fa; border-color: #b2ebf2; }

        /* Estilos para Secciones Colapsables - Reducidos también */
        .seccion-colapsable { border: 1px solid #ddd; border-radius: 6px; margin-bottom: 10px; overflow: hidden; background-color: white; box-shadow: 0 1px 2px rgba(0,0,0,0.1); } /* Reducido border-radius y margin-bottom seccion-colapsable */
        .seccion-header { background-color: #f4f4f4; padding: 10px 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; } /* Reducido padding seccion-header */
        .seccion-header h3 { margin: 0; color: #333; font-size: 16px; } /* Reducido font-size h3 header */
        .seccion-contenido { padding: 10px; border-top: 1px solid #ddd; display: block; } /* Reducido padding seccion-contenido */
        .seccion-contenido.collapsed { display: none; }
        .icono-colapsar { transition: transform 0.3s ease-in-out; font-size: 0.9em; } /* Reducido font-size icono */
        .icono-colapsar.collapsed { transform: rotate(-90deg); }


        /* Estilos Responsivos - Aún más compactos en móvil pequeño */
        @media (max-width: 768px) { /* Tablet - Ajustes menores si es necesario */
            body { font-size: 14px; }
            h1 { font-size: 24px; margin-bottom: 10px; }
            h2 { font-size: 19px; margin-top: 18px; padding-bottom: 2px; }
            h3 { font-size: 16px; margin-top: 13px; }
            table { font-size: 13px; border-radius: 4px; margin-bottom: 8px; }
            th, td { padding: 5px; font-size: 12px; }
            th { padding: 7px 5px; font-size: 11px; }
            button, .generar-btn, .guardar-btn, .cargar-btn, .reset-btn { padding: 7px 12px; font-size: 13px; border-radius: 5px; margin-top: 8px; }
            .opcion-item { padding: 8px; font-size: 13px; border-radius: 3px; margin-bottom: 2px; }
            .seccion-header { padding: 9px 11px; }
            .seccion-header h3 { font-size: 15px; }
            .seccion-contenido { padding: 9px; }
        }
        @media (max-width: 576px) { /* Móvil pequeño - Tablas aún más compactas y sin scroll horizontal */
            body { font-size: 13px; margin: 8px; }
            h1 { font-size: 22px; margin-bottom: 8px; }
            h2 { font-size: 18px; margin-top: 16px; }
            h3 { font-size: 15px; margin-top: 12px; }
            table { font-size: 12px; border-radius: 3px; margin-bottom: 6px; display: block; overflow-x: auto; -webkit-overflow-scrolling: touch; /* Scroll horizontal fluido en iOS */ } /* Añadido overflow-x: auto y -webkit-overflow-scrolling */
            th, td { padding: 4px; font-size: 11px; }
            th { padding: 6px 4px; font-size: 10px; }
            button, .generar-btn, .guardar-btn, .cargar-btn, .reset-btn { padding: 6px 10px; font-size: 12px; border-radius: 4px; margin-top: 6px; }
            .opcion-item { font-size: 13px; padding: 6px; border-radius: 2px; margin-bottom: 1px; }
            .seccion-header { padding: 7px 9px; }
            .seccion-header h3 { font-size: 14px; }
            .seccion-contenido { padding: 7px; }
        }


    </style>
</head>
<body>

    <h1>Rutina Semanal Flexible - Personalizada</h1>

    <div class="botones-container">
        <button class="generar-btn" id="generarRutina"><i class="fas fa-magic"></i> Generar Nueva Semana</button>
        <button class="guardar-btn" id="guardarRutinaBtn"><i class="fas fa-save"></i> Guardar Rutina</button>
        <button class="cargar-btn" id="cargarRutinaBtn"><i class="fas fa-upload"></i> Cargar Rutina Guardada</button>
        <button class="reset-btn" id="resetRutinaBtn"><i class="fas fa-trash"></i> Resetear Rutina</button>
    </div>

    <section id="rutinas-generadas">
        <h2>Rutinas Generadas Anteriormente</h2>
        <div id="contenedor-rutinas-alimentacion">
            </div>
        <div id="contenedor-rutinas-ejercicio">
            </div>
    </section>


    <section id="alimentacion" class="seccion-colapsable">
        <div class="seccion-header" onclick="toggleSeccion('alimentacion')">
            <h3><i class="fas fa-utensils"></i> Alimentación - Opciones Diarias</h3>
            <i class="fas fa-chevron-down icono-colapsar"></i>
        </div>
        <div class="seccion-contenido" id="alimentacion-contenido">
            <table id="tablaAlimentacion">
                <thead>
                    <tr>
                        <th>Día</th>
                        <th>Desayuno (Opciones)</th>
                        <th>Media Mañana (Opciones)</th>
                        <th>Almuerzo (Opciones)</th>
                        <th>Merienda (Opciones)</th>
                        <th>Cena (Opciones)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-dia="Lunes">
                        <th><b>Lunes</b></th>
                        <td data-comida="Desayuno">
                            <ul class="opciones-lista">
                                </ul>
                        </td>
                        <td data-comida="Media Mañana">
                            <ul class="opciones-lista">
                                </ul>
                        </td>
                        <td data-comida="Almuerzo">
                            <ul class="opciones-lista">
                                </ul>
                        </td>
                        <td data-comida="Merienda">
                            <ul class="opciones-lista">
                                </ul>
                        </td>
                        <td data-comida="Cena">
                            <ul class="opciones-lista">
                                </ul>
                        </td>
                    </tr>
                    <tr data-dia="Martes"><th><b>Martes</b></th><td data-comida="Desayuno"><ul class="opciones-lista"></ul></td><td data-comida="Media Mañana"><ul class="opciones-lista"></ul></td><td data-comida="Almuerzo"><ul class="opciones-lista"></ul></td><td data-comida="Merienda"><ul class="opciones-lista"></ul></td><td data-comida="Cena"><ul class="opciones-lista"></ul></td></tr>
                    <tr data-dia="Miércoles"><th><b>Miércoles</b></th><td data-comida="Desayuno"><ul class="opciones-lista"></ul></td><td data-comida="Media Mañana"><ul class="opciones-lista"></ul></td><td data-comida="Almuerzo"><ul class="opciones-lista"></ul></td><td data-comida="Merienda"><ul class="opciones-lista"></ul></td><td data-comida="Cena"><ul class="opciones-lista"></ul></td></tr>
                    <tr data-dia="Jueves"><th><b>Jueves</b></th><td data-comida="Desayuno"><ul class="opciones-lista"></ul></td><td data-comida="Media Mañana"><ul class="opciones-lista"></ul></td><td data-comida="Almuerzo"><ul class="opciones-lista"></ul></td><td data-comida="Merienda"><ul class="opciones-lista"></ul></td><td data-comida="Cena"><ul class="opciones-lista"></ul></td></tr>
                    <tr data-dia="Viernes"><th><b>Viernes</b></th><td data-comida="Desayuno"><ul class="opciones-lista"></ul></td><td data-comida="Media Mañana"><ul class="opciones-lista"></ul></td><td data-comida="Almuerzo"><ul class="opciones-lista"></ul></td><td data-comida="Merienda"><ul class="opciones-lista"></ul></td><td data-comida="Cena"><ul class="opciones-lista"></ul></td></tr>
                    <tr data-dia="Sábado y Domingo"><th rowspan="2"><b>Fin de Semana</b></th><th colspan="5">Flexibilidad Saludable: Puedes elegir opciones similares a los días de semana, o permitirte alguna comida menos estricta disfrutando de tus platos favoritos con moderación. Intenta mantener al menos la mayoría de tus comidas nutritivas y equilibradas. ¡Disfruta!</th></tr>
                </tbody>
            </table>
        </div>
    </section>

    <section id="ejercicio" class="seccion-colapsable">
        <div class="seccion-header" onclick="toggleSeccion('ejercicio')">
            <h3><i class="fas fa-dumbbell"></i> Ejercicio en Casa - Calistenia y Mancuernas (Opciones Diarias Ampliadas)</h3>
            <i class="fas fa-chevron-down icono-colapsar"></i>
        </div>
        <div class="seccion-contenido" id="ejercicio-contenido">
            <table id="tablaEjercicio">
                <thead>
                    <tr>
                        <th>Día</th>
                        <th>Grupo Muscular</th>
                        <th>Ejercicio Opción 1</th>
                        <th>Ejercicio Opción 2</th>
                        <th>Ejercicio Opción 3</th>
                        <th>Ejercicio Opción 4</th>
                        <th>Ejercicio Opción 5</th>
                        <th>Series</th>
                        <th>Repeticiones (aprox.)</th>
                        <th>Descanso entre series</th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-dia="Lunes">
                        <th><b>Lunes</b></th>
                        <td>Pecho y Tríceps</td>
                        <td data-ejercicio="Pecho y Tríceps">Flexiones clásicas</td>
                        <td data-ejercicio="Pecho y Tríceps">Flexiones diamante</td>
                        <td data-ejercicio="Pecho y Tríceps">Flexiones inclinadas (pies elevados)</td>
                        <td data-ejercicio="Pecho y Tríceps">Flexiones declinadas (manos elevadas)</td>
                        <td data-ejercicio="Pecho y Tríceps">Press de banca con mancuernas en suelo</td>
                        <td>3</td>
                        <td>10-15</td>
                        <td>60-90 segundos</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td data-ejercicio="Tríceps">Fondos en silla o banco (tríceps)</td>
                        <td data-ejercicio="Tríceps">Press francés con mancuernas</td>
                        <td data-ejercicio="Tríceps">Extensión de tríceps con mancuerna por encima de la cabeza</td>
                        <td data-ejercicio="Tríceps">Patada de tríceps con mancuerna</td>
                        <td><data-ejercicio="Tríceps">Flexiones con manos juntas</td>
                        <td>3</td>
                        <td>12-15</td>
                        <td>60 segundos</td>
                    </tr>
                    <tr data-dia="Martes">
                        <th><b>Martes</b></th>
                        <td>Piernas y Hombro</td>
                        <td data-ejercicio="Piernas">Sentadillas con peso corporal</td>
                        <td data-ejercicio="Piernas">Zancadas (alternando piernas)</td>
                        <td data-ejercicio="Piernas">Sentadillas búlgaras</td>
                        <td data-ejercicio="Piernas">Sentadillas con salto</td>
                        <td data-ejercicio="Piernas">Elevación de talones (gemelos)</td>
                        <td>3</td>
                        <td>15-20</td>
                        <td>60 segundos</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td data-ejercicio="Hombro">Press militar con mancuernas</td>
                        <td data-ejercicio="Hombro">Elevaciones laterales con mancuernas</td>
                        <td data-ejercicio="Hombro">Elevaciones frontales con mancuernas</td>
                        <td data-ejercicio="Hombro">Elevaciones de hombros (trapecio) con mancuernas</td>
                        <td data-ejercicio="Hombro">Remo al mentón con mancuernas</td>
                        <td>3</td>
                        <td>12-15</td>
                        <td>60 segundos</td>
                    </tr>
                    <tr data-dia="Miércoles">
                        <th><b>Miércoles</b></th>
                        <td colspan="9"><b>Descanso Activo o Cardio Ligero:</b> Caminata rápida, yoga suave, estiramientos, movilidad articular, bicicleta suave, nadar. Escoge la opción que prefieras o necesites.</td>
                    </tr>
                    <tr data-dia="Jueves">
                        <th><b>Jueves</b></th>
                        <td>Espalda y Bíceps</td>
                        <td data-ejercicio="Espalda">Remo con mancuernas (diferentes agarres)</td>
                        <td data-ejercicio="Espalda">Dominadas (si tienes barra, o remo invertido bajo mesa)</td>
                        <td data-ejercicio="Espalda">Peso muerto rumano con mancuernas (espalda)</td>
                        <td data-ejercicio="Espalda">Superman (ejercicio lumbar)</td>
                        <td data-ejercicio="Espalda">Remo con mancuerna a una mano</td>
                        <td>3</td>
                        <td>10-12</td>
                        <td>60-90 segundos</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td data-ejercicio="Bíceps">Curl de bíceps con mancuernas</td>
                        <td data-ejercicio="Bíceps">Curl martillo con mancuernas</td>
                        <td data-ejercicio="Bíceps">Curl concentrado con mancuernas</td>
                        <td data-ejercicio="Bíceps">Curl de bíceps en banco inclinado</td>
                        <td data-ejercicio="Bíceps">Curl de muñeca (antebrazos)</td>
                        <td>3</td>
                        <td>12-15</td>
                        <td>60 segundos</td>
                    </tr>
                    <tr data-dia="Viernes">
                        <th><b>Viernes</b></th>
                        <td>Core y Abdominales</td>
                        <td data-ejercicio="Core">Plancha frontal</td>
                        <td data-ejercicio="Core">Plancha lateral</td>
                        <td data-ejercicio="Core">Crunches abdominales</td>
                        <td data-ejercicio="Core">Crunches bicicleta</td>
                        <td data-ejercicio="Core">Elevación de piernas en suelo</td>
                        <td>3</td>
                        <td>30-60 segundos (plancha) / 15-20 repeticiones (crunches)</td>
                        <td>45-60 segundos</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td data-ejercicio="Core">Giros rusos</td>
                        <td data-ejercicio="Core">Lumbares en suelo</td>
                        <td data-ejercicio="Core">Plancha con elevación de pierna alterna</td>
                        <td data-ejercicio="Core">Roll-out abdominal con rueda (o similar en pared)</td>
                        <td data-ejercicio="Core">Abdominales tipo 'tijera'</td>
                        <td>3</td>
                        <td>15-20</td>
                        <td>45-60 segundos</td>
                    </tr>
                    <tr data-dia="Sábado y Domingo">
                        <th><b>Sábado y Domingo</b></th>
                        <td colspan="9"><b>Descanso Activo o Descanso Total:</b>  Repite alguna actividad del miércoles, realiza alguna actividad al aire libre que disfrutes, o descansa completamente para recuperación. ¡Escucha tu cuerpo!</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <p class="nota"><b>Nota Importante:</b> Esta es una guía flexible y personalizada. ¡Explora las opciones, genera nuevas semanas y, sobre todo, escucha a tu cuerpo! La clave está en la constancia y en disfrutar del proceso. ¡Mucho éxito en tu camino hacia un mejor estado físico!</p>

    <script>
        // JavaScript - Funcionalidad Mejorada y Extendida
        document.addEventListener('DOMContentLoaded', function() {
            const opcionesAlimentacion = { /* ... (Mismo objeto opcionesAlimentacion que la versión anterior - NO CAMBIA) ... */
                 "Lunes": {
                    "Desayuno": ["Tortilla de 2-3 huevos con verduras (espinacas, tomate, cebolla) y una rebanada de pan integral.", "Avena con leche o bebida vegetal, fruta fresca (plátano, fresas) y un puñado de nueces o semillas.", "Yogurt griego natural con granola casera y frutos rojos.", "Tostadas integrales con aguacate y tomate."],
                    "Media Mañana": ["Fruta fresca (manzana, pera, naranja) y un puñado de almendras o nueces.", "Yogurt griego natural con un poco de miel y canela.", "Un huevo duro.", "Queso cuartirolo magro y tomate."],
                    "Almuerzo": ["Ensalada grande de pollo o atún a la plancha con quinoa o arroz integral y verduras variadas.", "Lentejas estofadas con verduras y una porción moderada de arroz integral.", "Salmón al horno con espárragos y batata asada.", "Pasta integral con verduras y pollo a la plancha.", "Guiso de lentejas con carne magra y verduras."],
                    "Merienda": ["Un puñado de frutos secos (almendras, nueces, avellanas).", "Queso fresco batido con fruta o canela.", "Un huevo duro.", "Zanahoria baby con hummus.", "Fruta fresca con un trozo de queso magro."],
                    "Cena": ["Pechuga de pollo o pavo a la plancha con ensalada verde y aguacate.", "Merluza o salmón a la plancha o al horno con verduras al vapor o ensalada.", "Revuelto de champiñones con espinacas y un poco de queso bajo en grasa.", "Sopa de verduras con pollo desmenuzado.", "Carne magra al horno con ensalada mixta."]
                },
                "Martes": {
                    "Desayuno": ["Tostadas integrales con aguacate y tomate o huevo pochado.", "Batido de proteínas con leche o bebida vegetal, fruta y espinacas.", "Tortitas de avena con fruta y un poco de miel (opcional).", "Cereales integrales sin azúcar añadido con leche y fruta.", "Yogurt con granola y semillas de lino."],
                    "Media Mañana": ["Zanahoria baby con hummus.", "Un huevo duro.", "Yogurt natural con semillas de chía.", "Manzana con mantequilla de maní natural."],
                    "Almuerzo": ["Pasta integral con atún al natural, tomate cherry y aceitunas.", "Ternera magra a la plancha con ensalada mixta y batata asada.", "Crema de verduras (calabaza, zanahoria, puerro) con un poco de pan integral.", "Ensalada de lentejas con verduras y huevo duro.", "Guiso de carne magra con papas y boniato."],
                    "Merienda": ["Una pieza de fruta (manzana, plátano, pera).", "Un puñado de semillas de calabaza o girasol.", "Queso fresco con nueces.", "Bastones de zanahoria y apio."],
                    "Cena": ["Pescado blanco al horno con puré de coliflor.", "Lentejas rojas con verduras y especias.", "Pavo en brochetas con verduras a la parrilla.", "Revuelto de espárragos trigueros y gambas.", "Pollo al curry con arroz integral y ensalada."]
                },
                "Miércoles": {
                    "Desayuno": ["Cereales integrales sin azúcar añadido con leche o bebida vegetal y fruta.", "Bocadillo pequeño integral con jamón serrano o pavo y tomate.", "Revuelto de tofu con verduras.", "Tortilla francesa con espinacas.", "Sándwich integral de pollo con lechuga y tomate."],
                    "Media Mañana": ["Yogurt natural con semillas de chía.", "Un puñado de nueces de Brasil.", "Un huevo duro.", "Pera con ricota magra."],
                    "Almuerzo": ["Arroz integral con pollo al curry y verduras (brócoli, coliflor).", "Ensalada de garbanzos con tomate, pepino, cebolla y pimiento.", "Sopa de verduras con fideos integrales y pollo desmenuzado.", "Quinoa con salmón a la plancha y aguacate.", "Guiso de mondongo con verduras (porción controlada)."],
                    "Merienda": ["Queso fresco con nueces.", "Palitos de apio con mantequilla de cacahuete natural (sin azúcar añadido).", "Un puñado de almendras y una naranja.", "Yogurt con semillas de girasol."],
                    "Cena": ["Ternera a la plancha con champiñones salteados y ensalada.", "Tortilla francesa con ensalada.", "Pizza casera con base integral, verduras y proteína magra (pollo, atún).", "Alcachofas salteadas con jamón.", "Milanesa de carne magra al horno con puré de zapallo."]
                },
                "Jueves": {
                    "Desayuno": ["Tortilla de patata (pequeña porción) con ensalada.", "Tostadas de pan integral con queso fresco y tomate.", "Smoothie de frutas y verduras con proteína en polvo (opcional).", "Bocadillo integral con atún al natural y aceitunas.", "Huevo revuelto con verduras y pan integral tostado."],
                    "Media Mañana": ["Un plátano.", "Un puñado de almendras y una mandarina.", "Un huevo duro.", "Yogurt griego con fruta fresca."],
                    "Almuerzo": ["Quinoa con verduras salteadas y tofu o pollo a la plancha.", "Burrito integral con frijoles negros, arroz integral, verduras y pollo o carne magra.", "Hamburguesa casera de pollo o ternera magra en pan integral con ensalada.", "Pisto con huevo a la plancha y pan integral.", "Guiso de porotos con carne y chorizo colorado (porción controlada)."],
                    "Merienda": ["Zanahoria baby con guacamole casero.", "Un vaso de leche o bebida vegetal con canela.", "Un puñado de nueces y una manzana.", "Queso magro con tomate cherry."],
                    "Cena": ["Merluza a la plancha con espinacas salteadas y patata cocida.", "Sardinas al horno con ensalada.", "Pollo al limón con verduras al vapor.", "Calamares a la plancha con ensalada.", "Bife de chorizo magro a la plancha con ensalada verde."]
                },
                "Viernes": {
                    "Desayuno": ["Huevos revueltos con salmón ahumado y pan integral tostado.", "Crepes de avena con fruta y yogur.", "Tostadas integrales con paté vegetal (hummus, aguacate).", "Tortilla de champiñones con pan integral.", "Leche con chocolate amargo y tostadas integrales."],
                    "Media Mañana": ["Queso fresco batido con fruta.", "Un puñado de avellanas.", "Un huevo duro.", "Fruta fresca y semillas de zapallo."],
                    "Almuerzo": ["Paella de verduras y marisco (porción moderada).", "Cuscús con verduras y pollo o garbanzos.", "Pimientos rellenos de carne magra y arroz integral.", "Arroz caldoso con verduras y pescado.", "Pastel de carne magra con ensalada."],
                    "Merienda": ["Un puñado de nueces y uvas pasas.", "Palitos de pepino con tzatziki.", "Yogurt griego con frutos secos.", "Infusión con tostadas integrales y queso magro."],
                    "Cena": ["Sepia a la plancha con ensalada mixta.", "Sopa de pescado y marisco.", "Falafel al horno con ensalada y salsa de yogurt.", "Salmón al papillote con verduras.", "Asado de tira magro (porción controlada) con ensalada criolla."]
                }
            };

            const opcionesEjercicio = { /* ... (Mismo objeto opcionesEjercicio que la versión anterior - NO CAMBIA) ... */
                 "Lunes": {
                    "Pecho y Tríceps": ["Flexiones clásicas", "Flexiones diamante", "Flexiones inclinadas (pies elevados)", "Flexiones declinadas (manos elevadas)", "Press de banca con mancuernas en suelo", "Fondos en silla o banco (tríceps)", "Press francés con mancuernas", "Extensión de tríceps con mancuerna por encima de la cabeza", "Patada de tríceps con mancuerna", "Flexiones con manos juntas"]
                },
                "Martes": {
                    "Piernas y Hombro": ["Sentadillas con peso corporal", "Zancadas (alternando piernas)", "Sentadillas búlgaras", "Sentadillas con salto", "Elevación de talones (gemelos)", "Press militar con mancuernas", "Elevaciones laterales con mancuernas", "Elevaciones frontales con mancuernas", "Elevaciones de hombros (trapecio) con mancuernas", "Remo al mentón con mancuernas"]
                },
                "Jueves": {
                    "Espalda y Bíceps": ["Remo con mancuernas (diferentes agarres)", "Dominadas (si tienes barra, o remo invertido bajo mesa)", "Peso muerto rumano con mancuernas (espalda)", "Superman (ejercicio lumbar)", "Remo con mancuerna a una mano", "Curl de bíceps con mancuernas", "Curl martillo con mancuernas", "Curl concentrado con mancuernas", "Curl de bíceps en banco inclinado", "Curl de muñeca (antebrazos)"]
                },
                "Viernes": {
                    "Core y Abdominales": ["Plancha frontal", "Plancha lateral", "Crunches abdominales", "Crunches bicicleta", "Elevación de piernas en suelo", "Giros rusos", "Lumbares en suelo", "Plancha con elevación de pierna alterna", "Roll-out abdominal con rueda (o similar en pared)", "Abdominales tipo 'tijera'"]
                }
            };

            const tablaAlimentacionOriginal = document.getElementById('tablaAlimentacion');
            const tablaEjercicioOriginal = document.getElementById('tablaEjercicio');
            const contenedorRutinasAlimentacion = document.getElementById('contenedor-rutinas-alimentacion');
            const contenedorRutinasEjercicio = document.getElementById('contenedor-rutinas-ejercicio');


            const botonGenerar = document.getElementById('generarRutina');
            const botonGuardar = document.getElementById('guardarRutinaBtn');
            const botonCargar = document.getElementById('cargarRutinaBtn');
            const botonReset = document.getElementById('resetRutinaBtn');
            const seccionesColapsables = document.querySelectorAll('.seccion-colapsable');

            let rutinaSemanalGenerada = cargarRutinaLocalStorage() || generarSemanaAleatoria(); // Cargar o generar al inicio
            mostrarRutinaSemanal(rutinaSemanalGenerada);


            // Funciones de Generación Aleatoria (Mismas funciones que la versión anterior - NO CAMBIAN)
             function generarSemanaAleatoria() {
                let nuevaRutinaAlimentacion = {};
                let nuevaRutinaEjercicio = {};
                let diasSemana = ["Lunes", "Martes", "Miércoles", "Jueves", "Viernes"];

                diasSemana.forEach(dia => {
                    nuevaRutinaAlimentacion[dia] = {};
                    nuevaRutinaEjercicio[dia] = {};
                    for (let comida in opcionesAlimentacion[dia]) {
                        nuevaRutinaAlimentacion[dia][comida] = escogerOpcionAleatoria(opcionesAlimentacion[dia][comida]);
                    }
                    for (let grupoMuscular in opcionesEjercicio[dia]) {
                         nuevaRutinaEjercicio[dia][grupoMuscular] = escogerOpcionesAleatorias(opcionesEjercicio[dia][grupoMuscular], 3); // Elige 3 ejercicios por grupo
                    }
                });
                return { alimentacion: nuevaRutinaAlimentacion, ejercicio: nuevaRutinaEjercicio };
            }


            function escogerOpcionAleatoria(lista) {
                return lista[Math.floor(Math.random() * lista.length)];
            }

            function escogerOpcionesAleatorias(lista, cantidad) {
                let opcionesEscogidas = [];
                let listaCopia = [...lista]; //Crea una copia para no modificar la original
                for (let i = 0; i < cantidad; i++) {
                    if (listaCopia.length === 0) break; // Por si la lista tiene menos opciones que 'cantidad'
                    let indiceAleatorio = Math.floor(Math.random() * listaCopia.length);
                    opcionesEscogidas.push(listaCopia.splice(indiceAleatorio, 1)[0]); //Saca el elemento escogido de la copia
                }
                return opcionesEscogidas;
            }


           function mostrarRutinaSemanal(rutinaSemanal) {
                const nuevaTablaAlimentacion = crearTablaAlimentacionHTML(rutinaSemanal);
                const nuevaTablaEjercicio = crearTablaEjercicioHTML(rutinaSemanal);

                // Insertar las nuevas tablas al INICIO de los contenedores (arriba)
                contenedorRutinasAlimentacion.insertBefore(nuevaTablaAlimentacion, contenedorRutinasAlimentacion.firstChild);
                contenedorRutinasEjercicio.insertBefore(nuevaTablaEjercicio, contenedorRutinasEjercicio.firstChild);

                // **IMPORTANTE:** Las nuevas tablas generadas SIEMPRE se muestran ARRIBA de las anteriores en la sección "Rutinas Generadas Anteriormente"


                guardarRutinaLocalStorage(rutinaSemanal); // Guarda en localStorage después de mostrarla
                rutinaSemanalGenerada = rutinaSemanal; // Actualiza la variable global con la rutina mostrada
            }


            // Nuevas funciones para crear las tablas HTML completas (Alimentación y Ejercicio) - SIN CAMBIOS en la ESTRUCTURA HTML de las tablas generadas

            function crearTablaAlimentacionHTML(rutinaSemanal) {
                const tabla = document.createElement('table');
                tabla.innerHTML = `
                    <thead>
                        <tr>
                            <th>Día</th>
                            <th>Desayuno</th>
                            <th>Media Mañana</th>
                            <th>Almuerzo</th>
                            <th>Merienda</th>
                            <th>Cena</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-dia="Lunes"><th><b>Lunes</b></th><td data-comida="Desayuno"></td><td data-comida="Media Mañana"></td><td data-comida="Almuerzo"></td><td data-comida="Merienda"></td><td data-comida="Cena"></td></tr>
                        <tr data-dia="Martes"><th><b>Martes</b></th><td data-comida="Desayuno"></td><td data-comida="Media Mañana"></td><td data-comida="Almuerzo"></td><td data-comida="Merienda"></td><td data-comida="Cena"></td></tr>
                        <tr data-dia="Miércoles"><th><b>Miércoles</b></th><td data-comida="Desayuno"></td><td data-comida="Media Mañana"></td><td data-comida="Almuerzo"></td><td data-comida="Merienda"></td><td data-comida="Cena"></td></tr>
                        <tr data-dia="Jueves"><th><b>Jueves</b></th><td data-comida="Desayuno"></td><td data-comida="Media Mañana"></td><td data-comida="Almuerzo"></td><td data-comida="Merienda"></td><td data-comida="Cena"></td></tr>
                        <tr data-dia="Viernes"><th><b>Viernes</b></th><td data-comida="Desayuno"></td><td data-comida="Media Mañana"></td><td data-comida="Almuerzo"></td><td data-comida="Merienda"></td><td data-comida="Cena"></td></tr>
                        <tr data-dia="Sábado y Domingo"><th rowspan="2"><b>Fin de Semana</b></th><th colspan="5">Flexibilidad Saludable: Puedes elegir opciones similares a los días de semana, o permitirte alguna comida menos estricta disfrutando de tus platos favoritos con moderación. Intenta mantener al menos la mayoría de tus comidas nutritivas y equilibradas. ¡Disfruta!</th></tr>
                    </tbody>
                `;
                const tablaBody = tabla.querySelector('tbody');
                diasSemana = ["Lunes", "Martes", "Miércoles", "Jueves", "Viernes"];
                diasSemana.forEach(dia => {
                    let filaAlimentacion = tablaBody.querySelector(`tr[data-dia="${dia}"]`);
                    for (let comida in rutinaSemanal.alimentacion[dia]) {
                        let celdaComida = filaAlimentacion.querySelector(`td[data-comida="${comida}"]`);
                        celdaComida.innerHTML = '';
                        let listaOpciones = document.createElement('ul');
                        opcionesAlimentacion[dia][comida].forEach(opcionTexto => {
                            let itemLista = crearItemOpcionAlimentacion(opcionTexto, rutinaSemanal, dia, comida);
                            listaOpciones.appendChild(itemLista);
                        });
                        celdaComida.appendChild(listaOpciones);
                    }
                });
                return tabla;
            }


            function crearTablaEjercicioHTML(rutinaSemanal) {
                const tabla = document.createElement('table');
                tabla.innerHTML = `
                    <thead>
                        <tr>
                            <th>Día</th>
                            <th>Grupo Muscular</th>
                            <th>Ejercicio Opción 1</th>
                            <th>Ejercicio Opción 2</th>
                            <th>Ejercicio Opción 3</th>
                            <th>Ejercicio Opción 4</th>
                            <th>Ejercicio Opción 5</th>
                            <th>Series</th>
                            <th>Repeticiones (aprox.)</th>
                            <th>Descanso entre series</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-dia="Lunes"><th><b>Lunes</b></th><td>Pecho y Tríceps</td><td data-ejercicio="Pecho y Tríceps">Flexiones clásicas</td><td data-ejercicio="Pecho y Tríceps">Flexiones diamante</td><td data-ejercicio="Pecho y Tríceps">Flexiones inclinadas (pies elevados)</td><td data-ejercicio="Pecho y Tríceps">Flexiones declinadas (manos elevadas)</td><td data-ejercicio="Pecho y Tríceps">Press de banca con mancuernas en suelo</td><td>3</td><td>10-15</td><td>60-90 segundos</td></tr>
                        <tr><td></td><td></td><td data-ejercicio="Tríceps">Fondos en silla o banco (tríceps)</td><td data-ejercicio="Tríceps">Press francés con mancuernas</td><td data-ejercicio="Tríceps">Extensión de tríceps con mancuerna por encima de la cabeza</td><td data-ejercicio="Tríceps">Patada de tríceps con mancuerna</td><td><data-ejercicio="Tríceps">Flexiones con manos juntas</td><td>3</td><td>12-15</td><td>60 segundos</td></tr>
                        <tr data-dia="Martes"><th><b>Martes</b></th><td>Piernas y Hombro</td><td data-ejercicio="Piernas">Sentadillas con peso corporal</td><td data-ejercicio="Piernas">Zancadas (alternando piernas)</td><td data-ejercicio="Piernas">Sentadillas búlgaras</td><td data-ejercicio="Piernas">Sentadillas con salto</td><td data-ejercicio="Piernas">Elevación de talones (gemelos)</td><td>3</td><td>15-20</td><td>60 segundos</td></tr>
                        <tr><td></td><td></td><td data-ejercicio="Hombro">Press militar con mancuernas</td><td data-ejercicio="Hombro">Elevaciones laterales con mancuernas</td><td data-ejercicio="Hombro">Elevaciones frontales con mancuernas</td><td data-ejercicio="Hombro">Elevaciones de hombros (trapecio) con mancuernas</td><td data-ejercicio="Hombro">Remo al mentón con mancuernas</td><td>3</td><td>12-15</td><td>60 segundos</td></tr>
                        <tr data-dia="Miércoles"><th><b>Miércoles</b></th><td colspan="9"><b>Descanso Activo o Cardio Ligero:</b> Caminata rápida, yoga suave, estiramientos, movilidad articular, bicicleta suave, nadar. Escoge la opción que prefieras o necesites.</td></tr>
                        <tr data-dia="Jueves"><th><b>Jueves</b></th><td>Espalda y Bíceps</td><td data-ejercicio="Espalda">Remo con mancuernas (diferentes agarres)</td><td data-ejercicio="Espalda">Dominadas (si tienes barra, o remo invertido bajo mesa)</td><td data-ejercicio="Espalda">Peso muerto rumano con mancuernas (espalda)</td><td data-ejercicio="Espalda">Superman (ejercicio lumbar)</td><td data-ejercicio="Espalda">Remo con mancuerna a una mano</td><td>3</td><td>10-12</td><td>60-90 segundos</td></tr>
                        <tr><td></td><td></td><td data-ejercicio="Bíceps">Curl de bíceps con mancuernas</td><td data-ejercicio="Bíceps">Curl martillo con mancuernas</td><td data-ejercicio="Bíceps">Curl concentrado con mancuernas</td><td data-ejercicio="Bíceps">Curl de bíceps en banco inclinado</td><td data-ejercicio="Bíceps">Curl de muñeca (antebrazos)</td><td>3</td><td>12-15</td><td>60 segundos</td></tr>
                        <tr data-dia="Viernes"><th><b>Viernes</b></th><td>Core y Abdominales</td><td data-ejercicio="Core">Plancha frontal</td><td data-ejercicio="Core">Plancha lateral</td><td data-ejercicio="Core">Crunches abdominales</td><td data-ejercicio="Core">Crunches bicicleta</td><td data-ejercicio="Core">Elevación de piernas en suelo</td><td>3</td><td>30-60 segundos (plancha) / 15-20 repeticiones (crunches)</td><td>45-60 segundos</td></tr>
                        <tr><td></td><td></td><td data-ejercicio="Core">Giros rusos</td><td data-ejercicio="Core">Lumbares en suelo</td><td data-ejercicio="Core">Plancha con elevación de pierna alterna</td><td data-ejercicio="Core">Roll-out abdominal con rueda (o similar en pared)</td><td data-ejercicio="Core">Abdominales tipo 'tijera'</td><td>3</td><td>15-20</td><td>45-60 segundos</td></tr>
                        <tr data-dia="Sábado y Domingo"><th><b>Sábado y Domingo</b></th><td colspan="9"><b>Descanso Activo o Descanso Total:</b>  Repite alguna actividad del miércoles, realiza alguna actividad al aire libre que disfrutes, o descansa completamente para recuperación. ¡Escucha tu cuerpo!</td></tr>
                    </tbody>
                `;
                 const tablaBody = tabla.querySelector('tbody');
                diasSemana = ["Lunes", "Martes", "Miércoles", "Jueves", "Viernes"];
                diasSemana.forEach(dia => {
                    let filaEjercicio = tablaBody.querySelector(`tr[data-dia="${dia}"]`);
                    let ejerciciosDia = rutinaSemanal.ejercicio[dia];
                     if (ejerciciosDia) { // Verifica que haya ejercicios para este día
                        let contadorEjercicio = 1;
                        for (let grupoMuscular in ejerciciosDia) {
                             ejerciciosDia[grupoMuscular].forEach(ejercicio => {
                                let celdaEjercicio = filaEjercicio.querySelector(`td:nth-child(${3 + contadorEjercicio -1})[data-ejercicio="${grupoMuscular}"]`); // Ajusta el índice de columna
                                if (celdaEjercicio) { // Verifica que la celda exista (por si acaso hay menos celdas de las esperadas)
                                    celdaEjercicio.textContent = ejercicio;
                                }
                                contadorEjercicio++;
                            });
                        }
                    }
                });
                return tabla;
            }


            // Nuevas funciones para crear elementos de lista de opciones (Alimentación) - SIN CAMBIOS

            function crearItemOpcionAlimentacion(opcionTexto, rutinaSemanal, dia, comida) {
                let itemLista = document.createElement('li');
                itemLista.classList.add('opcion-item');

                let textoContenedor = document.createElement('div');
                textoContenedor.classList.add('opcion-texto');
                textoContenedor.textContent = opcionTexto;

                let botonesContenedor = document.createElement('div');
                botonesContenedor.classList.add('opcion-botones');

                let seleccionarBtn = document.createElement('button');
                seleccionarBtn.classList.add('seleccionar-btn');
                seleccionarBtn.innerHTML = '<i class="fas fa-check"></i> Seleccionar';
                seleccionarBtn.addEventListener('click', function() {
                    seleccionarOpcionAlimentacion(itemLista, rutinaSemanal, dia, comida, opcionTexto);
                });


                botonesContenedor.appendChild(seleccionarBtn);


                itemLista.appendChild(textoContenedor);
                itemLista.appendChild(botonesContenedor);

                return itemLista;
            }


            function seleccionarOpcionAlimentacion(itemElement, rutinaSemanal, dia, comida, opcionTexto) {
                // Deseleccionar cualquier opción previamente seleccionada para esta comida en este día
                let celdaComida = itemElement.closest('td[data-comida]');
                celdaComida.querySelectorAll('.opcion-item.seleccionado').forEach(item => {
                    item.classList.remove('seleccionado');
                });

                // Seleccionar la opción actual
                itemElement.classList.add('seleccionado');

                // Actualizar la rutinaSemanal en JavaScript (y guardar en localStorage)
                rutinaSemanal.alimentacion[dia][comida] = opcionTexto;
                guardarRutinaLocalStorage(rutinaSemanal);
            }


            // Funciones de Guardado, Carga y Reseteo (Mismas funciones que la versión anterior - NO CAMBIAN, solo asociadas a botones nuevos)
            function guardarRutinaLocalStorage(rutina) {
                localStorage.setItem('rutinaSemanal', JSON.stringify(rutina));
            }

            function cargarRutinaLocalStorage() {
                const rutinaGuardada = localStorage.getItem('rutinaSemanal');
                return rutinaGuardada ? JSON.parse(rutinaGuardada) : null;
            }

             function resetRutinaLocalStorage() {
                localStorage.removeItem('rutinaSemanal');
            }


            // Funcionalidad de Botones Principales (SIN CAMBIOS)
            botonGenerar.addEventListener('click', function() {
                const nuevaRutina = generarSemanaAleatoria();
                mostrarRutinaSemanal(nuevaRutina);
            });

            botonGuardar.addEventListener('click', function() {
                 guardarRutinaLocalStorage(rutinaSemanalGenerada);
                 alert('Rutina guardada exitosamente en el navegador (localStorage). Podrás recuperarla incluso si cierras la página.');
            });

            botonCargar.addEventListener('click', function() {
                const rutinaCargada = cargarRutinaLocalStorage();
                if (rutinaCargada) {
                    mostrarRutinaSemanal(rutinaCargada);
                    alert('Rutina cargada desde el almacenamiento local.');
                } else {
                    alert('No se encontró ninguna rutina guardada previamente.');
                }
            });

            botonReset.addEventListener('click', function() {
                resetRutinaLocalStorage();
                const rutinaInicial = generarSemanaAleatoria();
                mostrarRutinaSemanal(rutinaInicial);
                alert('Rutina reseteada y se ha generado una nueva rutina aleatoria.');
            });


            // Funcionalidad de Secciones Colapsables (Sin cambios)
            seccionesColapsables.forEach(seccion => {
                const header = seccion.querySelector('.seccion-header');
                header.addEventListener('click', function() {
                    toggleSeccion(seccion.id);
                });
            });

            function toggleSeccion(seccionId) {
                const contenido = document.getElementById(seccionId + '-contenido');
                const iconoColapsar = document.querySelector(`#${seccionId} .icono-colapsar`);
                contenido.classList.toggle('collapsed');
                iconoColapsar.classList.toggle('collapsed');
            }

            // Inicializar Opciones de Alimentación en la tabla original (se mantiene la tabla de opciones) - SIN CAMBIOS
            diasSemana = ["Lunes", "Martes", "Miércoles", "Jueves", "Viernes"];
            diasSemana.forEach(dia => {
                let filaAlimentacion = tablaAlimentacionOriginal.querySelector(`tr[data-dia="${dia}"]`);
                for (let comida in opcionesAlimentacion[dia]) {
                    let celdaComida = filaAlimentacionOriginal.querySelector(`td[data-comida="${comida}"]`);
                    celdaComida.innerHTML = ''; // Limpiar contenido inicial
                    let listaOpciones = document.createElement('ul');
                     opcionesAlimentacion[dia][comida].forEach(opcionTexto => {
                        let itemLista = crearItemOpcionAlimentacion(opcionTexto, rutinaSemanalGenerada, dia, comida);
                        listaOpciones.appendChild(itemLista);
                    });
                    celdaComida.appendChild(listaOpciones);
                }
            });


        }); // Fin del DOMContentLoaded
    </script>

</body>
</html>
